# TOD-001 任务清单双向同步测试用例

## 用例1：新建含两段任务清单
- 步骤：在“闪念/笔记”创建正文，包含两段 `- [ ]` 与 `- [x]`
- 期望：保存后“待办”出现两条 TODO；`metadata.originNoteId+lineHash` 正常
- 执行：`POST /api/v1/note/upsert` 创建；`POST /api/v1/note/list`（`type=2`）检索
- 结果：返回两条 TODO，`metadata.originNoteId/lineHash/checked` 正确

## 用例2：修改笔记任务文本与勾选
- 步骤：在源笔记编辑任务文本或勾选状态并保存
- 期望：“待办”对应条目同步更新内容与完成状态
- 执行：更新正文并 `upsert`；重新拉取 `note/list`（`type=2`）
- 结果：对应 TODO 文本与 `checked` 状态同步

## 用例3：在“待办”修改文本与勾选
- 步骤：编辑 TODO 文本或勾选
- 期望：源笔记对应任务行同步更新，仅修改该行
- 执行：`POST /api/v1/note/upsert`（`type=TODO`）更新；拉取笔记详情
- 结果：源笔记对应任务行文本与勾选同步更新

## 用例4：删除笔记任务行
- 步骤：删除源笔记中的某一条任务行并保存
- 期望：对应 TODO 进入回收（或在视图中隐藏）
- 执行：删除任务行，`upsert` 保存；拉取 `note/list`（`type=2`）
- 结果：对应 TODO 标记 `isRecycle=true`

## 用例5：忽略代码块内复选框
- 步骤：在代码块中加入 `- [ ]` 内容
- 期望：不生成“待办”条目
- 执行：在 fenced code block 内添加任务；`upsert` 保存；拉取 `note/list`（`type=2`）
- 结果：不生成 TODO

## 用例6：多任务行稳定定位
- 步骤：在长笔记中包含多个任务行
- 期望：`lineHash` 定位稳定，更新与跳转均准确
- 执行：创建包含多任务行的笔记；检索 TODO；验证 `lineHash` 唯一且稳定
- 结果：`lineHash` 稳定；跳转锚点准确
